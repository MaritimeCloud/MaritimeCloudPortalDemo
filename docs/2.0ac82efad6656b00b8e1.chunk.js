webpackJsonp([2],{1504:function(module,exports,__webpack_require__){"use strict";var core_1=__webpack_require__(0),common_1=__webpack_require__(14),administration_routing_1=__webpack_require__(1561),administration_component_1=__webpack_require__(1534),nga_module_1=__webpack_require__(120),approve_organization_module_1=__webpack_require__(1562),AdministrationModule=function(){function AdministrationModule(){}return AdministrationModule=__decorate([core_1.NgModule({imports:[common_1.CommonModule,nga_module_1.NgaModule,approve_organization_module_1.default,administration_routing_1.routing],declarations:[administration_component_1.AdministrationComponent]}),__metadata("design:paramtypes",[])],AdministrationModule)}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=AdministrationModule},1509:function(module,exports,__webpack_require__){"use strict";var core_1=__webpack_require__(0),SrViewModelService=function(){function SrViewModelService(){}return SrViewModelService.prototype.ngOnInit=function(){},SrViewModelService.prototype.generateLabelValuesForSpecification=function(specification){var labelValues=void 0;return specification&&(labelValues=[],labelValues.push({label:"ID",valueHtml:specification.specificationId}),labelValues.push({label:"Name",valueHtml:specification.name}),labelValues.push({label:"Version",valueHtml:specification.version}),labelValues.push({label:"Status",valueHtml:specification.status}),labelValues.push({label:"Description",valueHtml:specification.description})),labelValues},SrViewModelService.prototype.generateLabelValuesForDesign=function(design){var labelValues=void 0;return design&&(labelValues=[],labelValues.push({label:"ID",valueHtml:design.designId}),labelValues.push({label:"Name",valueHtml:design.name}),labelValues.push({label:"Version",valueHtml:design.version}),labelValues.push({label:"Status",valueHtml:design.status}),labelValues.push({label:"Description",valueHtml:design.description})),labelValues},SrViewModelService.prototype.generateLabelValuesForInstance=function(instance){var labelValues=void 0;return instance&&(labelValues=[],labelValues.push({label:"ID",valueHtml:instance.instanceId}),labelValues.push({label:"Name",valueHtml:instance.name}),labelValues.push({label:"Version",valueHtml:instance.version}),labelValues.push({label:"Status",valueHtml:instance.status}),labelValues.push({label:"Description",valueHtml:instance.description}),labelValues.push({label:"Service endpoint",valueHtml:instance.endpointUri})),labelValues},SrViewModelService=__decorate([core_1.Injectable(),__metadata("design:paramtypes",[])],SrViewModelService)}();exports.SrViewModelService=SrViewModelService},1510:function(module,exports,__webpack_require__){"use strict";var core_1=__webpack_require__(0),OrganizationViewModelService=function(){function OrganizationViewModelService(){}return OrganizationViewModelService.prototype.ngOnInit=function(){},OrganizationViewModelService.prototype.generateLabelValuesForOrganization=function(organization){var labelValues=void 0;return organization&&(labelValues=[],labelValues.push({label:"MRN",valueHtml:organization.mrn}),labelValues.push({label:"Name",valueHtml:organization.name}),labelValues.push({label:"Address",valueHtml:organization.address}),labelValues.push({label:"Country",valueHtml:organization.country}),organization.email&&labelValues.push({label:"Email",valueHtml:"<a href='mailto:"+organization.email+"'>"+organization.email+"</a>"}),organization.url&&labelValues.push({label:"Website",valueHtml:"<a href='"+organization.url+"' target='_blank'>"+organization.url+"</a>"})),labelValues},OrganizationViewModelService=__decorate([core_1.Injectable(),__metadata("design:paramtypes",[])],OrganizationViewModelService)}();exports.OrganizationViewModelService=OrganizationViewModelService},1511:function(module,exports,__webpack_require__){"use strict";var core_1=__webpack_require__(0),mc_notifications_service_1=__webpack_require__(74),navigation_helper_service_1=__webpack_require__(448),router_1=__webpack_require__(42),certificates_service_1=__webpack_require__(722),file_helper_service_1=__webpack_require__(719),CertificateIssueNewComponent=function(){function CertificateIssueNewComponent(fileHelper,certificateService,route,navigationHelper,notificationService){this.fileHelper=fileHelper,this.certificateService=certificateService,this.route=route,this.navigationHelper=navigationHelper,this.notificationService=notificationService}return CertificateIssueNewComponent.prototype.ngOnInit=function(){this.isLoading=!1;var entityType=this.route.snapshot.queryParams[navigation_helper_service_1.queryKeys.ENTITY_TYPE],entityMrn=this.route.snapshot.queryParams[navigation_helper_service_1.queryKeys.ENTITY_MRN],entityTitle=this.route.snapshot.queryParams[navigation_helper_service_1.queryKeys.ENTITY_TITLE];null!=entityType&&entityMrn&&entityTitle||(this.notificationService.generateNotification("Error","Unresolved state when trying to issue new certificate",mc_notifications_service_1.MCNotificationType.Error),this.navigationHelper.takeMeHome()),this.entityMrn=entityMrn,this.entityTitle=entityTitle,this.entityType=+entityType,this.generateLabelValues()},CertificateIssueNewComponent.prototype.zipAndDownload=function(){this.fileHelper.downloadPemCertificate(this.pemCertificate,this.entityTitle)},CertificateIssueNewComponent.prototype.issueNew=function(){var _this=this;this.isLoading=!0,this.certificateService.issueNewCertificate(this.entityType,this.entityMrn).subscribe(function(pemCertificate){_this.pemCertificate=pemCertificate,_this.isLoading=!1},function(err){_this.isLoading=!1,_this.notificationService.generateNotification("Error","Error when trying to issue new certificate",mc_notifications_service_1.MCNotificationType.Error,err)})},CertificateIssueNewComponent.prototype.cancel=function(){this.navigationHelper.cancelNavigateCertificates()},CertificateIssueNewComponent.prototype.generateLabelValues=function(){this.labelValues=[],this.labelValues.push({label:"Name",valueHtml:this.entityTitle}),this.labelValues.push({label:"MRN",valueHtml:this.entityMrn})},CertificateIssueNewComponent=__decorate([core_1.Component({selector:"certificate-issue-new",encapsulation:core_1.ViewEncapsulation.None,template:__webpack_require__(1520),styles:[]}),__metadata("design:paramtypes",["function"==typeof(_a="undefined"!=typeof file_helper_service_1.FileHelperService&&file_helper_service_1.FileHelperService)&&_a||Object,"function"==typeof(_b="undefined"!=typeof certificates_service_1.CertificatesService&&certificates_service_1.CertificatesService)&&_b||Object,"function"==typeof(_c="undefined"!=typeof router_1.ActivatedRoute&&router_1.ActivatedRoute)&&_c||Object,"function"==typeof(_d="undefined"!=typeof navigation_helper_service_1.NavigationHelperService&&navigation_helper_service_1.NavigationHelperService)&&_d||Object,"function"==typeof(_e="undefined"!=typeof mc_notifications_service_1.MCNotificationsService&&mc_notifications_service_1.MCNotificationsService)&&_e||Object])],CertificateIssueNewComponent);var _a,_b,_c,_d,_e}();exports.CertificateIssueNewComponent=CertificateIssueNewComponent},1512:function(module,exports,__webpack_require__){"use strict";var core_1=__webpack_require__(0),common_1=__webpack_require__(14),designs_table_component_1=__webpack_require__(1515),specifications_table_component_1=__webpack_require__(1518),nga_module_1=__webpack_require__(120),instances_table_component_1=__webpack_require__(1516),sr_view_model_service_1=__webpack_require__(1509),certificates_table_component_1=__webpack_require__(1514),certificate_helper_service_1=__webpack_require__(449),organization_details_table_component_1=__webpack_require__(1517),organization_view_model_service_1=__webpack_require__(1510),certificate_issue_new_component_1=__webpack_require__(1511),SharedModule=function(){function SharedModule(){}return SharedModule=__decorate([core_1.NgModule({imports:[common_1.CommonModule,nga_module_1.NgaModule],declarations:[designs_table_component_1.DesignsTableComponent,instances_table_component_1.InstancesTableComponent,specifications_table_component_1.SpecificationsTableComponent,certificates_table_component_1.CertificatesTableComponent,organization_details_table_component_1.OrganizationDetailsTableComponent,certificate_issue_new_component_1.CertificateIssueNewComponent],exports:[organization_details_table_component_1.OrganizationDetailsTableComponent,designs_table_component_1.DesignsTableComponent,instances_table_component_1.InstancesTableComponent,specifications_table_component_1.SpecificationsTableComponent,certificates_table_component_1.CertificatesTableComponent,certificate_issue_new_component_1.CertificateIssueNewComponent],providers:[sr_view_model_service_1.SrViewModelService,certificate_helper_service_1.CertificateHelperService,organization_view_model_service_1.OrganizationViewModelService]}),__metadata("design:paramtypes",[])],SharedModule)}();exports.SharedModule=SharedModule},1513:function(module,exports){"use strict"},1514:function(module,exports,__webpack_require__){"use strict";var core_1=__webpack_require__(0),certificate_helper_service_1=__webpack_require__(449),theme_constants_1=__webpack_require__(75),auth_service_1=__webpack_require__(21),navigation_helper_service_1=__webpack_require__(448),mc_notifications_service_1=__webpack_require__(74),file_helper_service_1=__webpack_require__(719),common_1=__webpack_require__(14),CertificatesTableComponent=function(){function CertificatesTableComponent(datePipe,fileHelper,navigationHelper,authService,certificateHelperService,notificationService){this.datePipe=datePipe,this.fileHelper=fileHelper,this.navigationHelper=navigationHelper,this.authService=authService,this.certificateHelperService=certificateHelperService,this.notificationService=notificationService,this.newCertificateTitle="Issue new Certificate",this.onIssueCertificate=this.issueCertificate.bind(this)}return CertificatesTableComponent.prototype.ngOnInit=function(){var _this=this;this.authService.authState.rolesLoaded||this.authService.rolesLoaded.subscribe(function(mode){_this.generateHeadersAndRows()})},CertificatesTableComponent.prototype.ngOnChanges=function(){this.certificates&&(this.certificateViewModels=this.certificateHelperService.convertCertificatesToViewModels(this.certificates),this.sortCertificates(),this.generateHeadersAndRows())},CertificatesTableComponent.prototype.generateHeadersAndRows=function(){var _this=this,tableHeaders=[],tableRows=[],tableHeader={title:"Certificate","class":""};tableHeaders.push(tableHeader),tableHeader={title:"Valid from","class":"nowrap"},tableHeaders.push(tableHeader),tableHeader={title:"Valid to","class":"nowrap"},tableHeaders.push(tableHeader),tableHeader={title:"","class":"table-buttons"},tableHeaders.push(tableHeader);for(var cells,tableCell,_loop_1=function(certificate){if(cells=[],tableCell={valueHtml:"Certificate for "+this_1.certificateTitle,"class":"",truncateNumber:50},cells.push(tableCell),tableCell={valueHtml:this_1.datePipe.transform(certificate.start,theme_constants_1.DATE_FORMAT),"class":"nowrap",truncateNumber:0},cells.push(tableCell),tableCell={valueHtml:this_1.datePipe.transform(certificate.end,theme_constants_1.DATE_FORMAT),"class":"nowrap",truncateNumber:0},cells.push(tableCell),certificate.revoked)tableCell={valueHtml:"Revoked ("+certificate.revokeReasonText+")","class":"red-text",truncateNumber:50},cells.push(tableCell);else{var actionButtons=[],actionButton={buttonClass:"btn btn-primary btn-raised btn-sm",name:"Download certificate",onClick:function(){_this.download(certificate)}};actionButtons.push(actionButton),this_1.isAdmin()&&(actionButton={buttonClass:"btn btn-danger btn-raised btn-sm",name:"Revoke certificate",onClick:function(){_this.revoke(certificate)}},actionButtons.push(actionButton));var tableCellActionButtons={valueHtml:"","class":"table-buttons",truncateNumber:0,actionButtons:actionButtons};cells.push(tableCellActionButtons)}var tableRow={cells:cells};tableRows.push(tableRow)},this_1=this,_i=0,_a=this.certificateViewModels;_i<_a.length;_i++){var certificate=_a[_i];_loop_1(certificate)}this.tableHeaders=tableHeaders,this.tableRows=tableRows},CertificatesTableComponent.prototype.sortCertificates=function(){this.certificateViewModels.sort(function(obj1,obj2){var obj1Time,obj2Time;return obj1Time="Date"==typeof obj1.end?obj1.end.getTime():obj1.end,obj2Time="Date"==typeof obj2.end?obj2.end.getTime():obj2.end,obj1.revoked&&obj2.revoked?obj2Time-obj1Time:obj1.revoked?1:obj2.revoked?-1:obj2Time-obj1Time})},CertificatesTableComponent.prototype.issueCertificate=function(){this.navigationHelper.navigateToIssueNewCertificate(this.certificateEntityType,this.entityMrn,this.certificateTitle)},CertificatesTableComponent.prototype.isAdmin=function(){return this.authService.authState.isAdmin()},CertificatesTableComponent.prototype.revoke=function(certificate){this.notificationService.generateNotification("Not Implemented","Revoke coming soon",mc_notifications_service_1.MCNotificationType.Info)},CertificatesTableComponent.prototype.download=function(certificate){var pemCertificate={certificate:certificate.certificate};this.fileHelper.downloadPemCertificate(pemCertificate,this.certificateTitle)},__decorate([core_1.Input(),__metadata("design:type",Object)],CertificatesTableComponent.prototype,"certificates",void 0),__decorate([core_1.Input(),__metadata("design:type","function"==typeof(_a="undefined"!=typeof certificate_helper_service_1.CertificateEntityType&&certificate_helper_service_1.CertificateEntityType)&&_a||Object)],CertificatesTableComponent.prototype,"certificateEntityType",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],CertificatesTableComponent.prototype,"entityMrn",void 0),__decorate([core_1.Input(),__metadata("design:type",Boolean)],CertificatesTableComponent.prototype,"isLoading",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],CertificatesTableComponent.prototype,"certificateTitle",void 0),CertificatesTableComponent=__decorate([core_1.Component({selector:"certificates-table",encapsulation:core_1.ViewEncapsulation.None,template:__webpack_require__(1521),styles:[__webpack_require__(1519)]}),__metadata("design:paramtypes",["function"==typeof(_b="undefined"!=typeof common_1.DatePipe&&common_1.DatePipe)&&_b||Object,"function"==typeof(_c="undefined"!=typeof file_helper_service_1.FileHelperService&&file_helper_service_1.FileHelperService)&&_c||Object,"function"==typeof(_d="undefined"!=typeof navigation_helper_service_1.NavigationHelperService&&navigation_helper_service_1.NavigationHelperService)&&_d||Object,"function"==typeof(_e="undefined"!=typeof auth_service_1.AuthService&&auth_service_1.AuthService)&&_e||Object,"function"==typeof(_f="undefined"!=typeof certificate_helper_service_1.CertificateHelperService&&certificate_helper_service_1.CertificateHelperService)&&_f||Object,"function"==typeof(_g="undefined"!=typeof mc_notifications_service_1.MCNotificationsService&&mc_notifications_service_1.MCNotificationsService)&&_g||Object])],CertificatesTableComponent);var _a,_b,_c,_d,_e,_f,_g}();exports.CertificatesTableComponent=CertificatesTableComponent},1515:function(module,exports,__webpack_require__){"use strict";var core_1=__webpack_require__(0),DesignsTableComponent=function(){function DesignsTableComponent(){}return DesignsTableComponent.prototype.ngOnInit=function(){},DesignsTableComponent.prototype.ngOnChanges=function(){this.designs&&this.generateHeadersAndRows()},DesignsTableComponent.prototype.generateHeadersAndRows=function(){var tableHeaders=[],tableRows=[],tableHeader={title:"Name","class":""};tableHeaders.push(tableHeader),tableHeader={title:"Version","class":"nowrap align-center"},tableHeaders.push(tableHeader),tableHeader={title:"Status","class":"nowrap"},tableHeaders.push(tableHeader),tableHeader={title:"Description","class":""},tableHeaders.push(tableHeader);for(var _i=0,_a=this.designs;_i<_a.length;_i++){var design=_a[_i],cells=[],tableCell={valueHtml:design.name,"class":"",truncateNumber:50};cells.push(tableCell),tableCell={valueHtml:design.version,"class":"nowrap align-center",truncateNumber:0},cells.push(tableCell),tableCell={valueHtml:design.status,"class":"nowrap",truncateNumber:0},cells.push(tableCell),tableCell={valueHtml:design.description,"class":"table-description",truncateNumber:250},cells.push(tableCell);var tableRow={cells:cells};tableRows.push(tableRow)}this.tableHeaders=tableHeaders,this.tableRows=tableRows},__decorate([core_1.Input(),__metadata("design:type",Object)],DesignsTableComponent.prototype,"designs",void 0),__decorate([core_1.Input(),__metadata("design:type",Boolean)],DesignsTableComponent.prototype,"isLoading",void 0),__decorate([core_1.Input(),__metadata("design:type",Function)],DesignsTableComponent.prototype,"onRowClick",void 0),DesignsTableComponent=__decorate([core_1.Component({selector:"designs-table",encapsulation:core_1.ViewEncapsulation.None,template:__webpack_require__(1522),styles:[]}),__metadata("design:paramtypes",[])],DesignsTableComponent)}();exports.DesignsTableComponent=DesignsTableComponent},1516:function(module,exports,__webpack_require__){"use strict";var core_1=__webpack_require__(0),InstancesTableComponent=function(){function InstancesTableComponent(){}return InstancesTableComponent.prototype.ngOnInit=function(){},InstancesTableComponent.prototype.ngOnChanges=function(){this.instances&&this.generateHeadersAndRows()},InstancesTableComponent.prototype.generateHeadersAndRows=function(){var tableHeaders=[],tableRows=[],tableHeader={title:"Name","class":""};tableHeaders.push(tableHeader),tableHeader={title:"Version","class":"nowrap align-center"},tableHeaders.push(tableHeader),tableHeader={title:"Status","class":"nowrap"},tableHeaders.push(tableHeader),tableHeader={title:"Description","class":""},tableHeaders.push(tableHeader);for(var _i=0,_a=this.instances;_i<_a.length;_i++){var instance=_a[_i],cells=[],tableCell={valueHtml:instance.name,"class":"",truncateNumber:50};cells.push(tableCell),tableCell={valueHtml:instance.version,"class":"nowrap align-center",truncateNumber:0},cells.push(tableCell),tableCell={valueHtml:instance.status,"class":"nowrap",truncateNumber:0},cells.push(tableCell),tableCell={valueHtml:instance.description,"class":"table-description",truncateNumber:250},cells.push(tableCell);var tableRow={cells:cells};tableRows.push(tableRow)}this.tableHeaders=tableHeaders,this.tableRows=tableRows},__decorate([core_1.Input(),__metadata("design:type",Object)],InstancesTableComponent.prototype,"instances",void 0),__decorate([core_1.Input(),__metadata("design:type",Boolean)],InstancesTableComponent.prototype,"isLoading",void 0),__decorate([core_1.Input(),__metadata("design:type",Function)],InstancesTableComponent.prototype,"onRowClick",void 0),InstancesTableComponent=__decorate([core_1.Component({selector:"instances-table",encapsulation:core_1.ViewEncapsulation.None,template:__webpack_require__(1523),styles:[]}),__metadata("design:paramtypes",[])],InstancesTableComponent)}();exports.InstancesTableComponent=InstancesTableComponent},1517:function(module,exports,__webpack_require__){"use strict";var core_1=__webpack_require__(0),Organization_1=__webpack_require__(1513),organization_view_model_service_1=__webpack_require__(1510),logo_service_1=__webpack_require__(720),auth_service_1=__webpack_require__(21),mc_notifications_service_1=__webpack_require__(74),OrganizationDetailsTableComponent=function(){function OrganizationDetailsTableComponent(authService,logoService,orgViewModelService,notifications){this.authService=authService,this.logoService=logoService,this.orgViewModelService=orgViewModelService,this.notifications=notifications,this.onLogoLoaded=new core_1.EventEmitter,this.isLoadingOrgAndLogo=!0,this.uploadingLogo=!1}return OrganizationDetailsTableComponent.prototype.ngOnChanges=function(){this.organization&&(this.canChangeLogo=this.canChangeTheLogo(),this.loadLogo())},OrganizationDetailsTableComponent.prototype.uploadLogo=function(logo){var _this=this,oldLogo=this.logo;this.uploadingLogo=!0,this.logoService.uploadLogo(this.organization.mrn,logo).subscribe(function(logo){_this.loadLogo()},function(err){_this.logo=oldLogo,_this.uploadingLogo=!1,_this.notifications.generateNotification("Error","Error when trying to upload logo",mc_notifications_service_1.MCNotificationType.Error,err)})},OrganizationDetailsTableComponent.prototype.setLabelValues=function(){this.labelValues=this.orgViewModelService.generateLabelValuesForOrganization(this.organization),this.isLoadingOrgAndLogo=!1},OrganizationDetailsTableComponent.prototype.loadLogo=function(){var _this=this;this.logoService.getLogoForOrganization(this.organization.mrn).subscribe(function(logo){_this.logo=URL.createObjectURL(new Blob([logo])),_this.setLabelValues(),_this.uploadingLogo=!1,_this.onLogoLoaded.emit("")},function(err){_this.canChangeTheLogo()&&(_this.logo="assets/img/no_organization.png"),_this.setLabelValues(),_this.uploadingLogo=!1,_this.onLogoLoaded.emit("")})},OrganizationDetailsTableComponent.prototype.canChangeTheLogo=function(){return this.authService.authState.isAdmin()&&this.authService.isMyOrg(this.organization.mrn)||this.authService.authState.isSiteAdmin()},__decorate([core_1.Input(),__metadata("design:type",Boolean)],OrganizationDetailsTableComponent.prototype,"isLoading",void 0),__decorate([core_1.Input(),__metadata("design:type","function"==typeof(_a="undefined"!=typeof Organization_1.Organization&&Organization_1.Organization)&&_a||Object)],OrganizationDetailsTableComponent.prototype,"organization",void 0),__decorate([core_1.Output(),__metadata("design:type","function"==typeof(_b="undefined"!=typeof core_1.EventEmitter&&core_1.EventEmitter)&&_b||Object)],OrganizationDetailsTableComponent.prototype,"onLogoLoaded",void 0),OrganizationDetailsTableComponent=__decorate([core_1.Component({selector:"organization-details-table",encapsulation:core_1.ViewEncapsulation.None,template:__webpack_require__(1524),styles:[]}),__metadata("design:paramtypes",["function"==typeof(_c="undefined"!=typeof auth_service_1.AuthService&&auth_service_1.AuthService)&&_c||Object,"function"==typeof(_d="undefined"!=typeof logo_service_1.LogoService&&logo_service_1.LogoService)&&_d||Object,"function"==typeof(_e="undefined"!=typeof organization_view_model_service_1.OrganizationViewModelService&&organization_view_model_service_1.OrganizationViewModelService)&&_e||Object,"function"==typeof(_f="undefined"!=typeof mc_notifications_service_1.MCNotificationsService&&mc_notifications_service_1.MCNotificationsService)&&_f||Object])],OrganizationDetailsTableComponent);var _a,_b,_c,_d,_e,_f}();exports.OrganizationDetailsTableComponent=OrganizationDetailsTableComponent},1518:function(module,exports,__webpack_require__){"use strict";var core_1=__webpack_require__(0),SpecificationsTableComponent=function(){function SpecificationsTableComponent(){}return SpecificationsTableComponent.prototype.ngOnInit=function(){},SpecificationsTableComponent.prototype.ngOnChanges=function(){this.specifications&&this.generateHeadersAndRows()},SpecificationsTableComponent.prototype.generateHeadersAndRows=function(){var tableHeaders=[],tableRows=[],tableHeader={title:"Name","class":""};tableHeaders.push(tableHeader),tableHeader={title:"Version","class":"nowrap align-center"},tableHeaders.push(tableHeader),tableHeader={title:"Status","class":"nowrap"},tableHeaders.push(tableHeader),tableHeader={title:"Description","class":""},tableHeaders.push(tableHeader);for(var _i=0,_a=this.specifications;_i<_a.length;_i++){var specification=_a[_i],cells=[],tableCell={valueHtml:specification.name,"class":"",truncateNumber:50};cells.push(tableCell),tableCell={valueHtml:specification.version,"class":"nowrap align-center",truncateNumber:0},cells.push(tableCell),tableCell={valueHtml:specification.status,"class":"nowrap",truncateNumber:0},cells.push(tableCell),tableCell={valueHtml:specification.description,"class":"table-description",truncateNumber:250},cells.push(tableCell);var tableRow={cells:cells};tableRows.push(tableRow)}this.tableHeaders=tableHeaders,this.tableRows=tableRows},__decorate([core_1.Input(),__metadata("design:type",Object)],SpecificationsTableComponent.prototype,"specifications",void 0),__decorate([core_1.Input(),__metadata("design:type",Boolean)],SpecificationsTableComponent.prototype,"isLoading",void 0),__decorate([core_1.Input(),__metadata("design:type",Function)],SpecificationsTableComponent.prototype,"onRowClick",void 0),SpecificationsTableComponent=__decorate([core_1.Component({selector:"specifications-table",encapsulation:core_1.ViewEncapsulation.None,template:__webpack_require__(1525),styles:[]}),__metadata("design:paramtypes",[])],SpecificationsTableComponent)}();exports.SpecificationsTableComponent=SpecificationsTableComponent},1519:function(module,exports){module.exports=".table-buttons {\n  width: 100%; }\n  .table-buttons button {\n    margin: 5px !important; }\n\n.certificate-table td {\n  vertical-align: middle; }\n\n.certificate-table td:first-child {\n  white-space: nowrap; }\n\n.certificate-table-short td {\n  vertical-align: middle; }\n\n.certificate-table-short td:first-child {\n  min-width: 200px; }\n"},1520:function(module,exports){module.exports='<div class="row">\r\n  <div class="col-lg-12">\r\n    <ba-card title="Issue new certificate" baCardClass="with-scroll table-panel">\r\n      <!-- Before issue -->\r\n      <div *ngIf="entityType != null && !pemCertificate && !isLoading">\r\n        <h5>Issuing a new certificate for:</h5>\r\n        <mc-label-value-table [isLoading]="isLoading" [labelValues]="labelValues"></mc-label-value-table>\r\n        <ul *ngIf="entityType != null" class="btn-list clearfix">\r\n          <li>\r\n            <button type="button" class="btn btn-danger btn-raised" (click)="issueNew()">Issue Certificate</button>\r\n          </li>\r\n          <li>\r\n            <button type="button" class="btn btn-default btn-raised" (click)="cancel()">Cancel</button>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n\r\n      <sk-fading-circle [isRunning]="isLoading" ></sk-fading-circle>\r\n\r\n      <!-- After issue and success -->\r\n      <div *ngIf="pemCertificate">\r\n        Certificate issued with success\r\n        <ul *ngIf="entityType != null" class="btn-list clearfix">\r\n          <li>\r\n            <button type="button" class="btn btn-primary btn-raised" (click)="zipAndDownload()">Download certificate</button>\r\n          </li>\r\n          <li>\r\n            <button type="button" class="btn btn-default btn-raised" (click)="cancel()">OK</button>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n    </ba-card>\r\n  </div>\r\n</div>\r\n'},1521:function(module,exports){module.exports='<mc-table [tableHeaders]="tableHeaders" [tableRows]="tableRows" [isLoading]="isLoading"></mc-table>\r\n<div *ngIf="!isLoading">\r\n  <mc-create-button [title]="newCertificateTitle" [onClick]="onIssueCertificate"></mc-create-button>\r\n</div>\r\n'},1522:function(module,exports){module.exports='<mc-table [tableHeaders]="tableHeaders" [tableRows]="tableRows" [isLoading]="isLoading" [onRowClick]="onRowClick"></mc-table>\r\n'},1523:function(module,exports){module.exports='<mc-table [tableHeaders]="tableHeaders" [tableRows]="tableRows" [isLoading]="isLoading" [onRowClick]="onRowClick"></mc-table>\r\n'},1524:function(module,exports){module.exports='<div *ngIf="logo" style="margin-bottom: 10px;">\r\n  <img class="logo-image-no-center" [attr.src]="logo | sanitizeUrl" *ngIf="logo && !canChangeLogo">\r\n  <mc-logo-uploader [logo]="logo" [uploadingLogo]="uploadingLogo" (onUpload)="uploadLogo($event)" *ngIf="logo && canChangeLogo"></mc-logo-uploader>\r\n</div>\r\n<mc-label-value-table [isLoading]="isLoadingOrgAndLogo" [labelValues]="labelValues"></mc-label-value-table>\r\n'},1525:function(module,exports){module.exports='<mc-table [tableHeaders]="tableHeaders" [tableRows]="tableRows" [isLoading]="isLoading" [onRowClick]="onRowClick"></mc-table>\r\n'},1526:function(module,exports,__webpack_require__){"use strict";var core_1=__webpack_require__(0),ApproveOrganizationComponent=function(){function ApproveOrganizationComponent(){}return ApproveOrganizationComponent=__decorate([core_1.Component({selector:"approve-organization",template:"<router-outlet></router-outlet>"}),__metadata("design:paramtypes",[])],ApproveOrganizationComponent)}();exports.ApproveOrganizationComponent=ApproveOrganizationComponent},1534:function(module,exports,__webpack_require__){"use strict";var core_1=__webpack_require__(0),AdministrationComponent=function(){function AdministrationComponent(){}return AdministrationComponent=__decorate([core_1.Component({selector:"administration",template:"<router-outlet></router-outlet>"}),__metadata("design:paramtypes",[])],AdministrationComponent)}();exports.AdministrationComponent=AdministrationComponent},1535:function(module,exports,__webpack_require__){"use strict";var core_1=__webpack_require__(0),router_1=__webpack_require__(42),mc_notifications_service_1=__webpack_require__(74),organizations_service_1=__webpack_require__(150),forms_1=__webpack_require__(20),mrn_helper_service_1=__webpack_require__(453),mc_utils_1=__webpack_require__(728),app_constants_1=__webpack_require__(457),users_service_1=__webpack_require__(451),roles_service_1=__webpack_require__(456),Role_1=__webpack_require__(727),RoleNameEnum=Role_1.Role.RoleNameEnum,ApproveDetailsComponent=function(){function ApproveDetailsComponent(route,router,notifications,userService,roleService,orgService,formBuilder,mrnHelper){this.route=route,this.router=router,this.notifications=notifications,this.userService=userService,this.roleService=roleService,this.orgService=orgService,this.formBuilder=formBuilder,this.mrnHelper=mrnHelper,this.isApproving=!1,this.approveTitle="Approve",this.mrnPattern=mrnHelper.mrnPattern(),this.mrnPatternError=mrnHelper.mrnPatternError()}return ApproveDetailsComponent.prototype.ngOnInit=function(){this.title="Approve organization",this.loadOrganization()},ApproveDetailsComponent.prototype.approve=function(){this.isApproving=!0,this.approveOrganization()},ApproveDetailsComponent.prototype.cancel=function(){this.router.navigate(["../"],{relativeTo:this.route})},ApproveDetailsComponent.prototype.loadOrganization=function(){var _this=this;this.isLoading=!0;var orgMrn=this.route.snapshot.params.id;this.orgService.getUnapprovedOrganization(orgMrn).subscribe(function(organization){_this.organization=organization,_this.userMrn=_this.mrnHelper.mrnMaskForUserOfOrg(organization.mrn),_this.generateForm()},function(err){_this.isLoading=!1,_this.notifications.generateNotification("Error","Error when trying to get the organization",mc_notifications_service_1.MCNotificationType.Error,err),_this.router.navigate(["../"],{relativeTo:_this.route})})},ApproveDetailsComponent.prototype.logoLoaded=function(){this.isLoading=!1},ApproveDetailsComponent.prototype.approveOrganization=function(){var _this=this;this.orgService.approveOrganization(this.organization.mrn).subscribe(function(organization){_this.createAdminRole()},function(err){_this.isApproving=!1,_this.notifications.generateNotification("Error","Error when trying to approve the organization",mc_notifications_service_1.MCNotificationType.Error,err)})},ApproveDetailsComponent.prototype.createAdminRole=function(){var _this=this,role={};role.permission=app_constants_1.MC_ADMIN,role.roleName=RoleNameEnum.ROLE_ORG_ADMIN,this.roleService.createRole(this.organization.mrn,role).subscribe(function(role){_this.createUser()},function(err){_this.isApproving=!1,_this.notifications.generateNotification("User not created","The organization was approved, but user creation failed. You can go to organizations and try to create the user again later.",mc_notifications_service_1.MCNotificationType.Alert,err),_this.router.navigate(["../"],{relativeTo:_this.route})})},ApproveDetailsComponent.prototype.createUser=function(){var _this=this,user={};
user.mrn=this.userMrn,user.firstName=this.userForm.value.firstName,user.lastName=this.userForm.value.lastName,user.permissions=app_constants_1.MC_ADMIN,user.email=this.userForm.value.emails.email,this.userService.createUser(this.organization.mrn,user).subscribe(function(user){_this.isApproving=!1,_this.notifications.generateNotification("Organization Approved","The organization was approved and now has access to the Maritime Cloud",mc_notifications_service_1.MCNotificationType.Success),_this.router.navigate(["../"],{relativeTo:_this.route})},function(err){_this.isApproving=!1,_this.notifications.generateNotification("User not created","The organization was approved, but user creation failed. You can go to organizations and try to create the user again later.",mc_notifications_service_1.MCNotificationType.Alert,err),_this.router.navigate(["../"],{relativeTo:_this.route})})},ApproveDetailsComponent.prototype.generateMRN=function(idValue){var mrn=idValue?idValue:"",valueNoSpaces=mrn.split(" ").join("").toLowerCase();this.userMrn=this.mrnHelper.mrnMaskForUserOfOrg(this.organization.mrn)+valueNoSpaces,this.userForm.patchValue({mrn:this.userMrn})},ApproveDetailsComponent.prototype.generateForm=function(){var _this=this;this.userForm=this.formBuilder.group({}),this.formControlModels=[];var formControlModel={formGroup:this.userForm,elementId:"mrn",inputType:"text",labelName:"MRN",placeholder:"",isDisabled:!0},formControl=new forms_1.FormControl(this.userMrn,formControlModel.validator);this.userForm.addControl(formControlModel.elementId,formControl),this.formControlModels.push(formControlModel),formControlModel={formGroup:this.userForm,elementId:"userId",inputType:"text",labelName:"User ID",placeholder:"Enter user ID to generate MRN",validator:forms_1.Validators.required,pattern:this.mrnPattern,errorText:this.mrnPatternError},formControl=new forms_1.FormControl("",formControlModel.validator),formControl.valueChanges.subscribe(function(param){return _this.generateMRN(param)}),this.userForm.addControl(formControlModel.elementId,formControl),this.formControlModels.push(formControlModel),formControlModel={formGroup:this.userForm,elementId:"firstName",inputType:"text",labelName:"First Name",placeholder:"First Name is required",validator:forms_1.Validators.required},formControl=new forms_1.FormControl("",formControlModel.validator),this.userForm.addControl(formControlModel.elementId,formControl),this.formControlModels.push(formControlModel),formControlModel={formGroup:this.userForm,elementId:"lastName",inputType:"text",labelName:"Last Name",placeholder:"Last Name is required",validator:forms_1.Validators.required},formControl=new forms_1.FormControl("",formControlModel.validator),this.userForm.addControl(formControlModel.elementId,formControl),this.formControlModels.push(formControlModel),mc_utils_1.McUtils.generateEmailConfirmGroup(this.formBuilder,this.userForm,this.formControlModels)},ApproveDetailsComponent=__decorate([core_1.Component({selector:"approve-details",encapsulation:core_1.ViewEncapsulation.None,template:__webpack_require__(1582),styles:[__webpack_require__(1581)]}),__metadata("design:paramtypes",["function"==typeof(_a="undefined"!=typeof router_1.ActivatedRoute&&router_1.ActivatedRoute)&&_a||Object,"function"==typeof(_b="undefined"!=typeof router_1.Router&&router_1.Router)&&_b||Object,"function"==typeof(_c="undefined"!=typeof mc_notifications_service_1.MCNotificationsService&&mc_notifications_service_1.MCNotificationsService)&&_c||Object,"function"==typeof(_d="undefined"!=typeof users_service_1.UsersService&&users_service_1.UsersService)&&_d||Object,"function"==typeof(_e="undefined"!=typeof roles_service_1.RolesService&&roles_service_1.RolesService)&&_e||Object,"function"==typeof(_f="undefined"!=typeof organizations_service_1.OrganizationsService&&organizations_service_1.OrganizationsService)&&_f||Object,"function"==typeof(_g="undefined"!=typeof forms_1.FormBuilder&&forms_1.FormBuilder)&&_g||Object,"function"==typeof(_h="undefined"!=typeof mrn_helper_service_1.MrnHelperService&&mrn_helper_service_1.MrnHelperService)&&_h||Object])],ApproveDetailsComponent);var _a,_b,_c,_d,_e,_f,_g,_h}();exports.ApproveDetailsComponent=ApproveDetailsComponent},1536:function(module,exports,__webpack_require__){"use strict";var core_1=__webpack_require__(0),router_1=__webpack_require__(42),organizations_service_1=__webpack_require__(150),mc_notifications_service_1=__webpack_require__(74),ApproveListComponent=function(){function ApproveListComponent(router,route,orgService,notifications){this.router=router,this.route=route,this.orgService=orgService,this.notifications=notifications,this.showModal=!1}return ApproveListComponent.prototype.ngOnInit=function(){this.isLoading=!0,this.onGotoDetails=this.gotoDetails.bind(this),this.loadOrganizations()},ApproveListComponent.prototype.loadOrganizations=function(){var _this=this;this.orgService.getUnapprovedOrganizations().subscribe(function(organizations){_this.organizations=organizations,_this.generateHeadersAndRows(),_this.isLoading=!1},function(err){_this.isLoading=!1,_this.notifications.generateNotification("Error","Error when trying to get organizations",mc_notifications_service_1.MCNotificationType.Error,err)})},ApproveListComponent.prototype.gotoDetails=function(index){this.approve(this.organizations[index])},ApproveListComponent.prototype.generateHeadersAndRows=function(){var _this=this,tableHeaders=[],tableRows=[],tableHeader={title:"Name","class":""};tableHeaders.push(tableHeader),tableHeader={title:"Country","class":"nowrap"},tableHeaders.push(tableHeader),tableHeader={title:"Address","class":"nowrap"},tableHeaders.push(tableHeader),tableHeader={title:"","class":"table-buttons"},tableHeaders.push(tableHeader);for(var cells,tableCell,_loop_1=function(organization){cells=[],tableCell={valueHtml:organization.name,"class":"",truncateNumber:70},cells.push(tableCell),tableCell={valueHtml:organization.country,"class":"nowrap",truncateNumber:0},cells.push(tableCell),tableCell={valueHtml:organization.address,"class":"table-description",truncateNumber:140},cells.push(tableCell);var actionButtons=[],actionButton={buttonClass:"btn btn btn-success btn-raised btn-sm",name:"Approve",onClick:function(){_this.approve(organization)}};actionButtons.push(actionButton),actionButton={buttonClass:"btn btn-danger btn-raised btn-sm",name:"Delete",onClick:function(){_this.delete(organization)}},actionButtons.push(actionButton);var tableCellActionButtons={valueHtml:"","class":"nowrap table-buttons",truncateNumber:0,actionButtons:actionButtons};cells.push(tableCellActionButtons);var tableRow={cells:cells};tableRows.push(tableRow)},_i=0,_a=this.organizations;_i<_a.length;_i++){var organization=_a[_i];_loop_1(organization)}this.tableHeaders=tableHeaders,this.tableRows=tableRows},ApproveListComponent.prototype.approve=function(organization){this.router.navigate([organization.mrn],{relativeTo:this.route})},ApproveListComponent.prototype.delete=function(organization){this.modalDescription="Do you want to delete "+organization.name,this.organizationToDelete=organization,this.showModal=!0},ApproveListComponent.prototype.cancelModal=function(){this.showModal=!1},ApproveListComponent.prototype.deleteForSure=function(){var _this=this;this.isLoading=!0,this.showModal=!1,this.orgService.deleteOrganization(this.organizationToDelete.mrn).subscribe(function(){_this.loadOrganizations()},function(err){_this.notifications.generateNotification("Error","Error when trying to delete organization",mc_notifications_service_1.MCNotificationType.Error,err)})},ApproveListComponent=__decorate([core_1.Component({selector:"approve-list",encapsulation:core_1.ViewEncapsulation.None,template:__webpack_require__(1583),styles:[]}),__metadata("design:paramtypes",["function"==typeof(_a="undefined"!=typeof router_1.Router&&router_1.Router)&&_a||Object,"function"==typeof(_b="undefined"!=typeof router_1.ActivatedRoute&&router_1.ActivatedRoute)&&_b||Object,"function"==typeof(_c="undefined"!=typeof organizations_service_1.OrganizationsService&&organizations_service_1.OrganizationsService)&&_c||Object,"function"==typeof(_d="undefined"!=typeof mc_notifications_service_1.MCNotificationsService&&mc_notifications_service_1.MCNotificationsService)&&_d||Object])],ApproveListComponent);var _a,_b,_c,_d}();exports.ApproveListComponent=ApproveListComponent},1561:function(module,exports,__webpack_require__){"use strict";var router_1=__webpack_require__(42),administration_component_1=__webpack_require__(1534),approve_organization_component_1=__webpack_require__(1526),site_admin_guard_service_1=__webpack_require__(726),routes=[{path:"",component:administration_component_1.AdministrationComponent,canActivate:[site_admin_guard_service_1.SiteAdminAuthGuard],children:[{path:"approve",component:approve_organization_component_1.ApproveOrganizationComponent}]}];exports.routing=router_1.RouterModule.forChild(routes)},1562:function(module,exports,__webpack_require__){"use strict";var core_1=__webpack_require__(0),common_1=__webpack_require__(14),approve_organization_routing_1=__webpack_require__(1563),approve_organization_component_1=__webpack_require__(1526),forms_1=__webpack_require__(20),nga_module_1=__webpack_require__(120),shared_module_1=__webpack_require__(1512),approve_list_component_1=__webpack_require__(1536),approve_details_component_1=__webpack_require__(1535),ApproveOrganizationModule=function(){function ApproveOrganizationModule(){}return ApproveOrganizationModule=__decorate([core_1.NgModule({imports:[common_1.CommonModule,nga_module_1.NgaModule,forms_1.FormsModule,forms_1.ReactiveFormsModule,shared_module_1.SharedModule,approve_organization_routing_1.routing],declarations:[approve_organization_component_1.ApproveOrganizationComponent,approve_list_component_1.ApproveListComponent,approve_details_component_1.ApproveDetailsComponent]}),__metadata("design:paramtypes",[])],ApproveOrganizationModule)}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=ApproveOrganizationModule},1563:function(module,exports,__webpack_require__){"use strict";var router_1=__webpack_require__(42),approve_organization_component_1=__webpack_require__(1526),approve_list_component_1=__webpack_require__(1536),approve_details_component_1=__webpack_require__(1535),routes=[{path:"approve",component:approve_organization_component_1.ApproveOrganizationComponent,data:{breadcrumb:"Approve organizations"},children:[{path:"",component:approve_list_component_1.ApproveListComponent},{path:":id",component:approve_details_component_1.ApproveDetailsComponent,data:{breadcrumb:"Details"}}]}];exports.routing=router_1.RouterModule.forChild(routes)},1581:function(module,exports){module.exports=".important-notice {\n  max-width: 440px;\n  line-height: 18px;\n  font-size: 18px;\n  margin-bottom: 15px; }\n  .important-notice > span {\n    font-style: italic;\n    font-weight: bold; }\n"},1582:function(module,exports){module.exports='<div class="row">\r\n  <div class="col-lg-12">\r\n    <ba-card title="{{title}}" baCardClass="with-scroll table-panel">\r\n      <organization-details-table (onLogoLoaded)="logoLoaded()" [isLoading]="isLoading" [organization]="organization"></organization-details-table>\r\n\r\n      <div  *ngIf="!isLoading">\r\n        <div class="separator"></div>\r\n\r\n        <div class="important-notice">To approve <span>{{organization.name}}</span>, you need to fill out the form below with a user, that will get administrative access to the organization.\r\n        </div>\r\n\r\n        <div class="separator"></div>\r\n\r\n        <mc-form [formGroup]="userForm" [formControlModels]="formControlModels" [isLoading]="isLoading" [isRegistering]="isApproving" [registerTitle]="approveTitle" (onCancel)="cancel()" (onRegister)="approve()"></mc-form>\r\n      </div>\r\n    </ba-card>\r\n\r\n\r\n  </div>\r\n</div>\r\n'},1583:function(module,exports){module.exports='<div class="row">\r\n  <div class="col-lg-12">\r\n    <ba-card title="Organizations needing approval" baCardClass="with-scroll table-panel">\r\n      <mc-table [tableHeaders]="tableHeaders" [tableRows]="tableRows" [isLoading]="isLoading" [onRowClick]="onGotoDetails"></mc-table>\r\n    </ba-card>\r\n  </div>\r\n</div>\r\n<mc-modal (onCancel)="cancelModal()" (onOk)="deleteForSure()" [show]="showModal" [title]="\'Delete organization\'" [description]="modalDescription" [cancelClass]="\'btn btn-default btn-raised\'" [cancelTitle]="\'Cancel\'" [okClass]="\'btn btn-danger btn-raised\'" [okTitle]="\'Delete\'"></mc-modal>\r\n'}});